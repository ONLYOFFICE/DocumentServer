<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <!--
        /**
        * o------------------------------------------------------------------------------o
        * | This file is part of the OfficeExcel package - you can learn more at:             |
        * |                                                                              |
        * |                          http://www.OfficeExcel.net                               |
        * |                                                                              |
        * | This package is licensed under the OfficeExcel license. For all kinds of business |
        * | purposes there is a small one-time licensing fee to pay and for non          |
        * | commercial  purposes it is free to use. You can read the full license here:  |
        * |                                                                              |
        * |                      http://www.OfficeExcel.net/LICENSE.txt                       |
        * o------------------------------------------------------------------------------o
        */
    -->
    <title>Using the DOMContentLoaded event to create your chart</title>
    
    <meta name="keywords" content="OfficeExcel html5 canvas charts docs domcontentloaded" />
    <meta name="description" content="An example of using OfficeExcel in conjunction with the new DOMContentLoaded event" />
    <meta name="googlebot" content="NOODP">
    
    <meta property="og:title" content="OfficeExcel: HTML5 Javascript charts library" />
    <meta property="og:description" content="A charts library based on the HTML5 canvas tag" />
    <meta property="og:image" content="http://www.OfficeExcel.net/images/logo.png"/>

    <link rel="stylesheet" href="../css/website.css" type="text/css" media="screen" />
    <link rel="icon" type="image/png" href="../images/favicon.png">
    
    <!-- Place this tag in your head or just before your close body tag -->
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    <meta name="keywords" content="OfficeExcel chart html5 javascript canvas" />
    <meta name="description" content="OfficeExcel: HTML5 Javascript charts library Javascript charts and HTML5 canvas charts library" />
    
    <script src="../libraries/OfficeExcel.common.core.js" ></script>
    <script src="../libraries/OfficeExcel.line.js" ></script>
    <!--[if lt IE 9]><script src="../excanvas/excanvas.original.js"></script><![endif]-->
    
    <script>
        window.onload = function ()
        {
            var duration = (new Date().getTime() - timer.getTime()) / 1000;
            document.getElementById("waiting").innerHTML = '<span style="color: green">Done! Extra time taken: ' + duration.toFixed(1) + ' seconds</span>';
            alert('The window.onload event fired, extra time taken: ' + duration.toFixed(1) + ' seconds');
        }
        
        function myFunc ()
        {
            var line = new OfficeExcel.Line('cvs', [4,3,2,4,5,6,7,4,8,9]);
            line.Set('chart.labels', ['Dez', 'Fliss','Geoff','Hoolio','John','Rich','Kev','Charles','Lou','Bob']);
            line.Set('chart.hmargin', 5);
            line.Set('chart.title', 'A demonstration of the DOMContentLoaded event');
            line.Set('chart.title.vpos', 0.5);
            line.Set('chart.tickmarks', 'circle');
            line.Set('chart.linewidth', 1.01);

            if (navigator.userAgent.indexOf('Chrome/6') == -1) {
                line.Set('chart.shadow', true);
                line.Set('chart.shadow.offsetx', 0);
                line.Set('chart.shadow.offsety', 0);
                line.Set('chart.shadow.blur', 15);
            }
            line.Draw();
        }
    
        /**
        * Install the function to the appropriate event
        */
        if(window.addEventListener) {
            window.addEventListener('DOMContentLoaded', myFunc, false);
        } else if (!OfficeExcel.isOld()) {
            document.attachEvent("onDOMContentLoaded", myFunc);
        } else {
            window.onload = function ()
            {
                myFunc();
            }
        }
        
        // Create a timer to show the difference
        timer = new Date();
    </script>

    <?php PrintAnalyticsCode() ?>
</head>
<body>

    
    <!-- Social networking buttons -->
        <?php
            $prefix = substr($_SERVER['SERVER_NAME'], 0, 3);
            require("/OfficeExcel.{$prefix}/social.html");
        ?>
    <!-- Social networking buttons -->


<div id="breadcrumb">
    <a href="../index.html">OfficeExcel: HTML5 Javascript charts library</a>
    >
    <a href="./index.html">Documentation</a>
    >
    DOMContentLoaded event
</div>

<h1>DOMContentLoaded <span>example</span></h1>

    <script>
        if (OfficeExcel.isOld()) {
            document.write('<div style="background-color: #fee; border: 2px dashed red; padding: 5px"><b>Important</b><br /><br /> Internet Explorer does not natively support the HTML5 canvas tag, so if you want to see the charts, you can either:<ul><li>Install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a></li><li>Use ExCanvas. This is provided in the OfficeExcel Archive.</li><li>Use another browser entirely. Your choices are Firefox 3.5+, Chrome 2+, Safari 4+ or Opera 10.5+. </li></ul> <b>Note:</b> Internet Explorer 9 fully supports the canvas tag.</div>');
        }
    </script>

    <p id="waiting" style="; font-weight: bold; font-size: 16pt"><span style="color: #aa0">Waiting for onload event...</span></p>




    <p style="background-color: #eee; border: 1px dashed gray; padding: 5px; height: 50px;">
        <span style="display: inline-block; margin-left: 10px; float: right">
            <script>
                document.write('<img src="http://ie.microsoft.com/testdrive/HTML5/DOMContentLoaded/whidbey.jpg?' + Math.random() + '" width="50" height="50" />&nbsp;');
                document.write('<img src="http://ie.microsoft.com/testdrive/HTML5/DOMContentLoaded/window.jpg?' + Math.random() + '" width="50" height="50" />&nbsp;');
                document.write('<img src="http://ie.microsoft.com/testdrive/HTML5/DOMContentLoaded/whidbey2.jpg?' + Math.random() + '" width="50" height="50" />');
            </script>
        </span>

        These images are here to pad the page and slow down loading so that the window.onload event is slowed. This makes the
        difference far more visible.
    </p>
    
    <canvas id="cvs" width="600" height="250" style="float: right">[No canvas support]</canvas>

    <p>
        The DOMContentLoaded event is an extremely useful event and can make a big impact on the performance of your pages, hence this
        example. The DOMContentLoaded event fires when the pages HTML and scripts have loaded, but not necessarily any images or CSS.
        This can make a big improvement on the apparent speed of your page(s).
    </p>
    
    <p>
        You can read more about the <i>DOMContentLoaded</i> event on the Mozilla site, <a href="https://developer.mozilla.org/en/Gecko-Specific_DOM_Events" target="_blank">here</a>,
        and the Microsoft site <a href="http://ie.microsoft.com/testdrive/HTML5/87DOMContent-Loaded/Default.html" target="_blank">here</a>.
    </p>

    <br clear="all" />

    <pre class="code">
function createGraph(func)
{
    if(window.addEventListener) {
        window.addEventListener('DOMContentLoaded', func, false);
    } else {
        document.attachEvent("onDOMContentLoaded", func);
    }
}
</pre>

    <h4>Browser support</h4>
    
    <p>
        The DOMContentLoaded event is supported by the following browsers:
    </p>
    
    <ul>
        <li>Google Chrome</li>
        <li><a href="https://developer.mozilla.org/en/Gecko-Specific_DOM_Events" target="_blank">Mozilla Firefox</a></li>
        <li>Apple Safari</li>
        <li>Opera ASA. Opera</li>
        <li><a href="http://ie.microsoft.com/testdrive/HTML5/87DOMContent-Loaded/Default.html" target="_blank">Microsoft Internet Explorer 9</a></li>
    </ul>
    
    <h4>See also</h4>
    
    You might also be interested in <a href="async.html">asynchronous</a> chart creation as an alternative.

</body>
</html>